<%= semantic_form_for [:admin, @item], :html => { :enctype => "multipart/form-data" }  do |f| %>

  <%= f.inputs :name => "Required Main Information" do %>
    <%= f.input :category, :as => :select, 
           :label_method => 'title', 
           :value_method => :id, 
           :label => "Category",
           :required => true
    %>
    <%= f.input :title, :label => "Main Title", :required => true %>
    <%= f.input :highlight, :label => "Article Highlight", :required => true %>
    <%= f.input :abstract, 
                :hint => "Use a Single Paragraph for Abstract", 
                :required => true, 
                :input_html => { :rows => 10 } 
    %>
    <%= f.input :body, 
                :label => "Main Content", 
                :required => true, 
                :input_html => { :rows => 60, :cols => 120} %>
  <% end %>
  
  <%= f.inputs :name => "Tags" do %>
    <div class="medium_box">
      <%= f.input :general_tags, :as => :check_boxes, :label => "General",
          :collection => GeneralTag.find(:all, :order => "title ASC")
      %>
    </div>
    <div class="medium_box">
      <%= f.input :region_tags, :as => :check_boxes, :labels => "Regional",
          :collection => RegionTag.find(:all, :order => "title ASC") 
      %>
    </div>
    <div class="medium_box">
      <%= f.input :country_tags, :as => :check_boxes, :labels => "Countries",
          :collection => CountryTag.find(:all, :order => "title ASC") 
      %>
    </div>
  <% end %>
  
  <%= f.inputs :name => "Optional" do %>
    <%= f.input :author_name, :hint => "If blank, your 'Name' will be used" %>
    <%= f.input :author_email, :hint => "If blank, your 'Email' will be used" %>
    <%= f.input :source_url %>
  <% end %>
  
  
  <%= f.inputs :name => "Status Codes" do %>
    <%= f.input :draft, :hint => "Set to draft if you have not finished with editing." %><br />
    <%= f.input :featured, :hint => "Will be featured on front page." %><br />
    <%= f.input :allow_comments, :hint => "Allow users to comment" %><br />
    <%= f.input :protected_record, :hint => "Locked from editing, use with caution." %><br />
    <%#= f.input :share_twitter, :hint => "Post on twitter?" %>
    <%#= f.input :share_facebook, :hint => "Share on facebook?" %>
    <%#= f.input :share_facebook, :hint => "Share on linkedin?" %>
  <% end %>
  
  <%= f.inputs :name => "Dates and Status" do %>
    <%= f.input :published_at, :hint => "When article will go live (default: 1 hour from now)", :time => true %>
    <%= f.input :expires_on, :hint => "Expiration Date of article (default: never)", :time => true %>
  <% end %>

  <% f.object.attachments.build %>
  <%= f.inputs :name => "Main Image", :multipart => true do %>
    <%= f.semantic_fields_for :attachments do |attachment| %>
      <% if attachment.object.new_record? %>
        <%= attachment.input :description, :as => "string", :label => "Image Caption" %>
        <%= attachment.input :image, :as => "file", :label => "Choose File to upload" %>
      <% else %>
        <h3>Current Images: </h3>
        <h4><%= attachment.object.title %></h4>
        <%= link_to(image_tag(attachment.object.image.medium, :class => "show_item_img"), admin_attachment_path(attachment.object)) %>
        <p>
          <%= link_to "Edit", edit_admin_attachment_path(attachment.object) %> - 
          <%= link_to "Delete", admin_attachment_path(attachment.object), :method => 'delete', 
                :confirm => "Are You sure you want to delete this Image?" 
          %>
        </p>
      <% end %>
    <% end %>
  <% end %>
  
  
  <%= f.inputs :name => "Editor Notes" do %>
    <%= f.input :author_status, 
          :as => :select, 
          :label => "Author Status",
          :collection => ["Ready to go", "Needs Editing", "Needs Translation", "Needs Image"]
    %>
    <%= f.input :editor_notes, :as => "string" %>
    <%= f.input :updated_reason, :as => "string", :hint => "Provide reason for editing short as possible, 2-4 words." %>
    
  <% end %>
  
  <%= f.input(:user_id, :label => false, :as => :hidden, :value => current_admin_user.id) if f.object.new_record? %>
  
  <%= f.buttons :commit %>
<% end %>



<script type="text/javascript">
  $(function() {
    $('#item_body').tinymce({
      theme : "advanced",
      height : "640px",
      plugins : "autolink,lists,spellchecker,pagebreak,style,layer,save,advhr,advimage,advlink,emotions,iespell,inlinepopups,insertdatetime,preview,media,searchreplace,print,paste,directionality,fullscreen,noneditable,visualchars,nonbreaking,xhtmlxtras,template",
      // Theme options
      theme_advanced_buttons1 : "save,newdocument,|,bold,italic,underline,strikethrough,|,justifyleft,justifycenter,justifyright,justifyfull,|,styleselect,formatselect,fontselect,fontsizeselect",
      theme_advanced_buttons2 : "cut,copy,paste,pastetext,pasteword,|,search,replace,|,bullist,numlist,|,outdent,indent,blockquote,|,undo,redo,|,link,unlink,anchor,image,cleanup,help,code,|,insertdate,inserttime,preview,|,forecolor,backcolor",
      theme_advanced_buttons3 : "hr,removeformat,visualaid,|,sub,sup,|,charmap,emotions,iespell,media,advhr,|,print,|,ltr,rtl,|,fullscreen",
      theme_advanced_buttons4 : "insertlayer,moveforward,movebackward,absolute,|,styleprops,spellchecker,|,cite,abbr,acronym,del,ins,attribs,|,visualchars,nonbreaking,template,blockquote,pagebreak,|,insertfile,insertimage",
      theme_advanced_toolbar_location : "top",
      theme_advanced_toolbar_align : "left",
      theme_advanced_statusbar_location : "bottom",
      theme_advanced_resizing : true,

      // Replace values for the template plugin
      template_replace_values : {
        username : "<%= current_admin_user.email %>",
        staffid : "<%= current_admin_user.id %>"
      }
    });
  });
</script>